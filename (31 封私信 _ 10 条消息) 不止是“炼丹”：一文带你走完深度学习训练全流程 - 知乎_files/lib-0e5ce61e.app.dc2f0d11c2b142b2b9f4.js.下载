"use strict";(self.webpackChunkheifetz=self.webpackChunkheifetz||[]).push([[887],{64099:function(e,t,n){n.d(t,{$f:function(){return tC},As:function(){return ty},BU:function(){return tV},EN:function(){return tg},Ho:function(){return tF},RK:function(){return tW},RP:function(){return tP},S_:function(){return tm},TS:function(){return e$},Zd:function(){return tQ},cx:function(){return eY},pE:function(){return tU},rI:function(){return tG}});var o,r,a=n(9338),i=n(22107),c=n(94707),l=n(87320),s=n(55164),d=n(57477),u=n(71728),f=n(94009),h=n(79065),m=n(49899),p=n(30971),g=n(85879),v=n(87363),k=n(88329),A=n.n(k),b=n(69383);n(75570);var C=n(88169),y=n(65733),w=n(38151),x=n(91850),L=n(17103),B=n(83537),_=n(14168),z=n.n(_),Z=n(67814),S=n.n(Z),I=n(41402),G=n(37831),R=n(92769),N=n.n(R),E=n(88423),T=n(74135),P=n(76073),W=n.n(P),D=n(7629),M=n(78842),K=n(30722),V=n(88642),q=n(11612),U=n.n(q),X=n(41550),j=n(7459),H=n(60006),O=n(23579),F=n(80565),Q=n(74351),Y=n(18837),J=n.n(Y),$=n(20072),ee=n(61533),et=n(4667),en=n.n(et),eo=n(32193),er=n(54231),ea=n(57045),ei=n(51940);function ec(){var e=(0,h._)(["\n   from { opacity: 0; }\n   to { opacity: 1; }\n"]);return ec=function(){return e},e}var el=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach(function(t){"function"==typeof t?t(e):t&&(t.current=e)})}};function es(e){var t=this;return e.length?function(n,o){for(var r=e.length-1,a=n;r>=0;)a=e[r].call(t,a,o),r--;return a}:A()}var ed=function(e){var t=function(e){if(0!==e.intersectionRatio){var t=e.target;t.dataset.zaDetailViewId=t.cardShowViewId,b.Z.trackCardShow(t,{},{link:{url:t.href}}),n.unobserve(t),t.clickViewId&&(t.dataset.zaDetailViewId=t.clickViewId)}},n=new IntersectionObserver(function(e){e.forEach(t)},{threshold:[.1]});return[{cardShowViewId:1042,clickViewId:1043,selector:"a.external, a.internal"},{cardShowViewId:1044,clickViewId:1045,selector:"a.member_mention, a.UserLink-link"},{cardShowViewId:174,clickViewId:175,selector:"a.video-box"},{cardShowViewId:171,clickViewId:172,selector:'a[data-draft-type="link-card"]'},{cardShowViewId:7692,selector:"a.FileLinkCard .FileLinkCard-info"},{cardShowViewId:9744,selector:".Catalog"}].forEach(function(t){var o=t.selector,r=t.cardShowViewId,a=t.clickViewId;Array.from(e.querySelectorAll(o)).forEach(function(e){e.cardShowViewId=r,e.clickViewId=a,n.observe(e)})}),function(){n.disconnect()}},eu="function"==typeof queueMicrotask?queueMicrotask:function(e){return Promise.resolve().then(e)},ef=function(e){var t=(0,v.useRef)(null);(0,v.useEffect)(function(){if(e)return eu(function(){e&&(t.current=ed(e))}),function(){t.current&&t.current()}},[e])},eh=function(e){return{elementLocation:{type:"Button",content:{type:e.dataset.zaContentType}}}},em=function(e){return{attachedInfoBytes:e.dataset.zaAttachInfo}},ep=[{selector:"a.external, a.internal",zaBlock:"ZTextLink"},{selector:"a.member_mention, a.UserLink-link, a.ztext-mention-hook",zaBlock:"ZTextMention"},{selector:"a.video-box",zaBlock:"ZTextVideoCard"},{selector:'a.LinkCard.old[data-draft-type="link-card"]',zaBlock:"ZTextLinkCard"},{selector:'a.LinkCard.new.static[data-draft-type="link-card"]:not([data-za-content-type="Zvideo"])',zaBlock:"ZTextLinkCard",viewInfoBuilder:eh,extraInfoBuilder:em},{selector:'a.LinkCard.new.static[data-draft-type="link-card"][data-za-content-type="Zvideo"]',zaBlock:"ZTextZVideoLinkCard",viewInfoBuilder:eh,extraInfoBuilder:em},{selector:"a.FileLinkCard",zaBlock:"ZTextFileLinkCard"}],eg=function(e){var t,n,o=e.element,r=e.config,a=null===(t=r.viewInfoBuilder)||void 0===t?void 0:t.call(r,o,r),i=(0,s._)({elementLocation:{type:"Button"},block:r.zaBlock},a),c=(0,s._)({action:"OpenUrl",elementLocation:{type:"Button"},block:r.zaBlock,eventType:"Click"},a),l=(0,s._)({link:{url:o.href}},null===(n=r.extraInfoBuilder)||void 0===n?void 0:n.call(r,o,r)),d=(0,C.useTracker)().trackEvent,u=(0,C.useShow)(i,l),f=(0,y.A)(function(e){d(c,l),"ZTextLinkCard"===r.zaBlock&&o.dataset.isEcommerce&&e.preventDefault()});return(0,v.useEffect)(function(){return o.addEventListener("click",f),function(){o.removeEventListener("click",f)}},[]),(0,v.useEffect)(function(){return u(o),function(){return u(null)}},[]),null},ev=function(e){var t=e.root,n=(0,f._)((0,v.useState)([]),2),o=n[0],r=n[1];return(0,v.useEffect)(function(){if(t){var e=[];ep.forEach(function(n){var o=n.selector;Array.from(t.querySelectorAll(o)).forEach(function(t){e.push({el:t,config:n})})}),r(e)}},[t]),(0,g.tZ)(v.Fragment,{children:o.map(function(e,t){var n=e.el,o=e.config;return(0,g.tZ)(eg,{element:n,config:o},t)})})},ek=/<p><br><\/p>/g,eA=/<[^<>\s]+(\s|>)/,eb=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBK05A)}},eC=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBL07A)}},ey=function(e){return{color:e.colors.GBL07A,"&:hover":eC(e)}},ew=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"[data-focus-visible]";return(0,l._)({outline:"none",transition:"box-shadow 0.3s"},"html".concat(t," &"),{boxShadow:"0 0 0 2px ".concat(e.colors.GBK99A,", 0 0 0 4px ").concat(e.colorMod(e.colors.GBL01A).alpha(.3))})},ex=(0,I.F4)(ec()),eL="#fff",eB=function(e){var t="1.4em";return(0,s._)({wordBreak:"break-word",lineHeight:"1.6","> [data-first-child]":{marginTop:0},"> :last-child":{marginBottom:0},"h1,h2":{clear:"left",marginTop:"calc((".concat(t," * 2) / 1.2)"),marginBottom:"calc(".concat(t," / 1.2)"),fontSize:"1.2em",lineHeight:1.5,fontWeight:e.fontWeights.bold},"h3,h4,h5,h6":{clear:"left",marginTop:"calc((".concat(t," * 1.5) / 1.1)"),marginBottom:"calc(".concat(t," / 1.1)"),fontSize:"1.1em",lineHeight:"1.5",fontWeight:e.fontWeights.bold},u:{textDecoration:"none",borderBottom:"1px solid ".concat(e.colors.GBK03A)},b:{fontWeight:e.fontWeights.bold},sup:{fontSize:"0.8em"},"sup[data-draft-type='reference']":{color:e.colors.GBL07A},"a:focus":ew(e),"a.ztext-link,a.internal,a.external":(0,d._)((0,s._)({textDecoration:"none",cursor:"pointer"},eb(e)),{"&:hover":(0,s._)({color:e.colors.GBL07A},eC(e))," > .ellipsis::after":{content:"'...'"},"> .invisible":{font:"0/0 a",color:"transparent",textShadow:"none",backgroundColor:"transparent"},u:{border:"none"}}),"a.member_mention":ey(e),"a.UserLink-link":ey(e),p:{margin:"".concat(t," 0")},"p.ztext-empty-paragraph":{margin:"calc((".concat("2.8em","- (").concat(t," * 2 + 1.6em)) / 2) 0"),"+ .ztext-empty-paragraph":{margin:"".concat(t," 0")}},hr:{margin:"4em auto",width:"240px",maxWidth:"100%",border:"none",borderTop:"1px solid ".concat(e.colors.GBK08A)},"img[eeimg]":(0,s._)({maxWidth:"100%",verticalAlign:"middle"},e.isDarkMod&&{filter:"invert(1)"}),'img[eeimg="1"]':{margin:"0 3px",maxWidth:"calc(100% - 6px)",display:"inline-block"},'img[eeimg="2"]':{margin:"".concat(t," auto"),display:"block"},blockquote:{margin:"".concat(t," 0"),paddingLeft:"1em",color:e.colors.GBK04A,borderLeft:"3px solid ".concat(e.colors.GBK08A)},"ol,ul":{margin:"".concat(t," 0"),padding:0,width:"100%","ol,ul":{margin:0},"li::before":{width:"1em"},"> ol, > ul":{paddingLeft:"1em",boxSizing:"border-box"}},ul:{"&>li":{display:"table",width:"100%",listStyle:"none","&::before":{display:"table-cell",content:"'•  '",whiteSpace:"pre"}}},ol:{counterReset:"ol","> li":{display:"table",width:"100%",listStyle:"none","&::before":{display:"table-cell",textAlign:"right",counterIncrement:"ol",content:"counter(ol) '. '",whiteSpace:"pre"}}},"ol ol":{counterReset:"ol2","li::before":{counterIncrement:"ol2",content:"counter(ol2) '. '"}},"ol ol ol":{counterReset:"ol3","li::before":{counterIncrement:"ol3",content:"counter(ol3) '. '"}},"ol ol ol ol":{counterReset:"ol4","li::before":{counterIncrement:"ol4",content:"counter(ol4) '. '"}},figure:{margin:"".concat(t," 0"),".content_image,.origin_image":{margin:"0 auto"},figcaption:{marginTop:"calc(0.6em / 0.9)",padding:"0 1em",fontSize:"0.9em",lineHeight:"1.5",textAlign:"center",color:e.colors.GBK06A},"& + figure":{marginTop:"calc(".concat(t," * 1.6)")},"&[data-size='small'],&:not([data-size]) > [data-size='small']":{clear:"both"},"&[data-size='left'],&:not([data-size]) > [data-size='left']":{float:"left",margin:"0 20px 20px 0",maxWidth:"33%"},"&[data-size='right'],&:not([data-size]) > [data-size='right']":{float:"right",margin:"0 0 20px 20px",maxWidth:"33%"},"&[data-size='collapse']":{marginBottom:0,"& + figure":{marginTop:0}}},".content_image, .origin_image":{display:"block",maxWidth:"100%",height:"auto",margin:"".concat(t," auto"),backgroundColor:eL,"&[data-size='small']":{maxWidth:"40%"},"&.zh-lightbox-thumb":{cursor:"zoom-in"}},code:{margin:"0 2px",padding:"3px 4px",borderRadius:"3px",fontFamily:e.fonts.monospace,fontSize:"0.9em",backgroundColor:e.colors.GBK10A},pre:{margin:"".concat(t," 0"),padding:"calc(0.8em / 0.9)",fontSize:"0.9em",wordBreak:"initial",wordWrap:"initial",whiteSpace:"pre",overflow:"auto",WebkitOverflowScrolling:"touch",background:e.colors.GBK10A,borderRadius:"4px",code:{margin:0,padding:0,fontSize:"inherit",borderRadius:0,backgroundColor:"inherit"}},"li pre":{whiteSpace:"pre-wrap"},"table[data-draft-type='table']":{borderCollapse:"collapse",fontSize:"15px",margin:"".concat(t," auto"),maxWidth:"100%",tableLayout:"fixed",textAlign:"left",width:"100%","&[data-size='small']":{minWidth:"260px",width:"40%"},"&[data-row-style='striped'] tr:nth-of-type(2n + 1)":{background:e.colors.GBK10A},"td,th":{border:"1px solid ".concat(e.colors.GBK08A),lineHeight:"24px",height:"24px",padding:"3px 12px"},th:{background:e.colors.GBK09A,color:e.colors.GBK02A,fontWeight:500}},"& .video-box, & .link-box":{position:"relative",display:"flex",justifyContent:"space-between",margin:"".concat(t," 0"),overflow:"auto",whiteSpace:"normal",cursor:"pointer",border:"solid 1px ".concat(e.colors.GBK09A),borderRadius:"4px"}},{".lazy[data-lazy-status]":{backgroundColor:e.colors.GBK10A},'.lazy[data-lazy-status="ok"]':{backgroundColor:eL,animation:"".concat(ex," 0.5s ease-in")}})},e_=[function(e){return e?e.replace(ek,'<p class="ztext-empty-paragraph"><br /></p>'):e},function(e){return e?e.replace(eA,function(e,t){return e.replace(t," data-first-child".concat(t))}):e}],ez=(0,v.forwardRef)(function(e,t){var n,o=e.as,r=e.tag,a=e.className,i=e.html,c=e.clearBoth,l=void 0!==c&&c,d=e.richContentKey,f=e.root,h=e.Portal,m=e.useHooks,p=(0,u._)(e,["as","tag","className","html","clearBoth","richContentKey","root","Portal","useHooks"]),v=es(e_);m(f);var k=null!==(n=null!=o?o:r)&&void 0!==n?n:"div";return(0,g.BX)(g.HY,{children:[h&&(0,g.tZ)(h,{root:f}),(0,g.tZ)(k,(0,s._)({ref:t,css:function(e){return(0,s._)({},eB(e),{"& .highlight":{margin:"1em 0",pre:{margin:0},".hll":{backgroundColor:e.colors.GBK12A},".c":{fontStyle:"italic",color:e.colors.GBK06A},".err":{color:e.colors.GRD03A},".k":{fontWeight:e.fontWeights.bold},".o":{fontWeight:e.fontWeights.bold},".cm":{fontStyle:"italic",color:e.colors.GBK06A},".cp":{fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".c1":{fontStyle:"italic",color:e.colors.GBK06A},".cs":{fontStyle:"italic",fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".gd":{color:e.colors.GRD01A},".ge":{fontStyle:"italic"},".gr":{color:e.colors.GRD03A},".gh":{color:e.colors.GBK06A},".gi":{color:"#12b370"},".go":{color:e.colors.GBK05A},".gp":{color:e.colors.GBK04A},".gs":{fontWeight:e.fontWeights.bold},".gu":{color:e.colors.GBK06A},".gt":{color:e.colors.GRD03A},".kc":{fontWeight:e.fontWeights.bold},".kd":{fontWeight:e.fontWeights.bold},".kn":{fontWeight:e.fontWeights.bold},".kp":{fontWeight:e.fontWeights.bold},".kr":{fontWeight:e.fontWeights.bold},".kt":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".m":{color:e.colors.GBL01A},".s":{color:e.colors.GRD03A},".na":{color:e.colors.GBL01A},".nb":{color:e.colors.GBL01A},".nc":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".no":{color:e.colors.GBL01A},".ni":{color:e.colors.GRD07A},".ne":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nf":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nn":{color:e.colors.GBK04A},".nt":{color:e.colors.GBL07A},".nv":{color:e.colors.GBL01A},".ow":{fontWeight:e.fontWeights.bold},".w":{color:e.colors.GBK07A},".mf":{color:e.colors.GBL01A},".mh":{color:e.colors.GBL01A},".mi":{color:e.colors.GBL01A},".mo":{color:e.colors.GBL01A},".sb":{color:e.colors.GRD03A},".sc":{color:e.colors.GRD03A},".sd":{color:e.colors.GRD03A},".s2":{color:e.colors.GRD03A},".se":{color:e.colors.GRD03A},".sh":{color:e.colors.GRD03A},".si":{color:e.colors.GRD03A},".sx":{color:e.colors.GRD03A},".sr":{color:e.colors.GYL02A},".s1":{color:e.colors.GRD03A},".ss":{color:e.colors.GRD03A},".bp":{color:e.colors.GBK06A},".vc":{color:e.colors.GBL01A},".vg":{color:e.colors.GBL01A},".vi":{color:e.colors.GBL01A},".il":{color:e.colors.GBL01A},"&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-thumb:horizontal":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.5),borderRadius:"6px","&:hover":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.6)}}}},l&&{"&::before, &::after":{clear:"both",content:'""',display:"block"}})},className:S()("RichText","ztext",a,{"RichText--clearBoth":l}),dangerouslySetInnerHTML:{__html:v(i)}},p),d||i)]})});ez.propTypes={as:z().string,tag:z().string,html:z().string.isRequired,clearBoth:z().bool,ref:z().func,Portal:z().func,useHooks:z().func},ez.defaultProps={useHooks:A()};var eZ=(0,v.memo)(ez),eS=function(e,t){if(e>0&&t>0){var n=e/t;if(n>1.2)return"180x120";if(n<=.8)return"120x160"}return"ipico"},eI=(0,v.forwardRef)(function(e,t){var n=N()(e,["entityType","entityData","notCommerce"]),o=n.text,r=n.target,a=n.url,i=n.image,c=n.imageWidth,l=n.imageHeight,f=n.component,h=n.className,m=n.size,p=n.children,v=(0,u._)(n,["text","target","url","image","imageWidth","imageHeight","component","className","size","children"]),k=eS(c,l),A=(0,E.imgUrl)(i,k);return(0,g.tZ)(f,(0,d._)((0,s._)((0,d._)((0,s._)({ref:t,target:r,href:a,"data-draft-node":"block","data-draft-type":"link-card"},A&&{"data-image":A},c&&{"data-image-width":c},l&&{"data-image-height":l},m&&{"data-size":m},o!==a&&o&&{"data-text":o}),{className:S()("LinkCard new",h)}),v),{children:p||(0,g.BX)(g.HY,{children:[(0,g.tZ)("span",{className:"LinkCard-image LinkCard-image--default"}),(0,g.BX)("span",{className:"LinkCard-contents",children:[(0,g.tZ)("span",{className:"LinkCard-title loading","data-text":!0}),(0,g.tZ)("span",{className:"LinkCard-desc loading"})]})]})}))});eI.propTypes={component:z().oneOfType([z().string,z().func]),target:z().string,url:z().string.isRequired,text:z().string,image:z().string,imageWidth:z().oneOfType([z().string,z().number]),imageHeight:z().oneOfType([z().string,z().number])},eI.defaultProps={component:"a",target:"_blank"};var eG={answer:{en:"Answer",zh:"回答"},article:{en:"Article",zh:"文章"},zvideo:{en:"Video",zh:"视频"},question:{en:"Question",zh:"问题"},collection:{en:"Collection",zh:"收藏夹"},roundtable:{en:"Roundtable",zh:"圆桌"},topic:{en:"Topic",zh:"话题"},voteupCount:{en:"Voteup",zh:"赞同"},commentCount:{en:"Comment",zh:"评论"},playCount:{en:"Play",zh:"播放"},followerCount:{en:"Follower",zh:"关注"},answerCount:{en:"Answer",zh:"回答"},visitCount:{en:"Visit",zh:"浏览"},discussionCount:{en:"Discussion",zh:"讨论"}},eR=function(e){return["column","podcast-channel","podcast-episode","ailab","zhi-da-session","zhi-da-share","zhi-da-folder"].includes(e)},eN=function(e){if(!e)return{};try{var t=JSON.parse(e);if(!t||"object"!=typeof t)return{};return(0,T.camelizeKeys)(t)}catch(e){return{}}},eE=function(e){return e?eR(e.objectType)?eN(e.extraInfo).title||"":e.extraInfo?eN(e.extraInfo).title||e.title||"":e.title||"":""},eT=function(e){if(!e)return"";var t=eN(e.extraInfo);return t.coverImage||t.cover||e.thumbnail||""},eP={answer:"回答",article:"文章",zvideo:"视频",question:"问题",collection:"收藏夹",roundtable:"圆桌",topic:"话题",pin:"想法"},eW={voteupCount:"赞同",commentCount:"评论",playCount:"播放",followerCount:"关注",answerCount:"回答",visitCount:"浏览",discussionCount:"讨论"},eD={answer:["voteupCount","commentCount"],article:["voteupCount","commentCount"],zvideo:["playCount","voteupCount"],question:["followerCount","answerCount"],collection:["visitCount","followerCount"],topic:["visitCount","discussionCount"],default:["followerCount","visitCount"]},eM=function(e){var t=e.twoLine,n=e.children;return!!n&&(0,g.tZ)("span",{className:S()("LinkCard-title",{"two-line":t}),children:n})},eK=function(e){var t,n,o=e.data,r=e.language,a=o.objectType,i="",c=eN(o.extraInfo);return c.desc?(i=c.desc||"",(0,g.tZ)("span",{className:"LinkCard-desc LinkCard-desc-wrapper",dangerouslySetInnerHTML:{__html:i}})):(i=(eD[a]||eD.default).map(function(e){var t,n=o[e];return"".concat((0,K.Zh)(n)).concat(null!==(t=eG[e][r])&&void 0!==t?t:eW[e])}).filter(Boolean).join(" \xb7 "),(0,g.BX)("span",{className:"LinkCard-desc LinkCard-desc-wrapper-line-clamp",children:[i,(0,g.tZ)("span",{children:(0,g.tZ)("span",{className:"LinkCard-tag",children:null!==(n=null===(t=eG[a])||void 0===t?void 0:t[r])&&void 0!==n?n:eP[a]})})]}))},eV=function(e){var t=e.url,n=(0,v.useMemo)(function(){var e=null,n=W()(t,!0);return"link.zhihu.com"===n.hostname&&(e=n.query.target),(e||t||"").replace(/^https?:\/\//,"")},[t]);return(0,g.BX)("span",{className:"LinkCard-desc",children:[(0,g.tZ)(D.n,{size:14,center:!0}),n]})},eq=function(e){var t=e.url,n=e.isVideo,o=e.ratio,r=e.onClick;return!!t&&(0,g.BX)("span",{className:"LinkCard-image",style:{height:66*(void 0===o?1:o)},children:[(0,g.tZ)("img",{src:t,onClick:r,alt:n?"点击可播放视频":""}),n&&(0,g.tZ)("span",{className:"LinkCard-image--video",children:(0,g.tZ)(M.D,{size:10,center:!0})})]})},eU=(0,v.forwardRef)(function(e,t){var n=e.url,o=e.data,r=e.onClick,a=e.onClickImage,i=e.language,c=o.title,l=o.thumbnail,s=o.objectType;return(0,g.BX)(g.HY,{children:[(0,g.tZ)(eq,{url:l,isVideo:"zvideo"===s,onClick:a}),(0,g.BX)("span",{ref:t,className:"LinkCard-contents",onClick:r,children:[(0,g.tZ)(eM,{twoLine:!0,children:c}),s?(0,g.tZ)(eK,{data:o,language:void 0===i?"zh":i}):(0,g.tZ)(eV,{url:n})]})]})}),eX=function(e){var t=e.className,n=e.html;return n?(0,g.tZ)("span",{className:"LinkCard-richText ".concat(t),dangerouslySetInnerHTML:{__html:"<object>".concat(n,"</object>")}}):null},ej=function(e){var t=e.data,n=t.title,o=t.desc,r=t.url,a=t.image,i=t.ratio,c=t.isVideo;return(0,g.BX)(g.HY,{children:[(0,g.tZ)(eq,{url:a,ratio:i,isVideo:c}),(0,g.BX)("span",{className:"LinkCard-contents",children:[(0,g.tZ)(eM,{twoLine:!0,children:n},"title"),(0,g.tZ)(eX,{className:"LinkCard-desc",html:o}),!o&&(0,g.tZ)(eV,{url:r},"url")]})]})},eH={ANSWER:"Answer",ARTICLE:"Column",ZVIDEO:"Zvideo",QUESTION:"Question",COLLECTION:"Collection",ROUNDTABLE:"Roundtable",SPECIAL:"Special",TOPIC:"Topic"},eO=function(e){var t={};if(e.data){var n=(0,T.camelizeKeys)("string"==typeof e.data?JSON.parse(e.data):e.data),o=n.source,r=n.display,a=void 0===r?{}:r,i=n.zaData,c=a.cardOpenUrl,l=a.title,u=a.content,f=a.desc,h=a.image||{};t={source:void 0===o?{}:o,url:c,title:l,content:u,desc:f,image:h.imageUrl,ratio:h.ratio,isVideo:h.isVideo,zaAttachInfo:(void 0===i?{}:i).attachInfo}}return(0,d._)((0,s._)({},t,e),{title:e.text||t.title,image:t.image||e.image})},eF=(0,v.forwardRef)(function(e,t){var n=(0,v.useMemo)(function(){return eO(e)},[e]),o=n.source,r=n.target,a=n.title,i=n.url,c=n.zaAttachInfo;return(0,g.tZ)(eI,{ref:t,notCommerce:!0,target:r,text:a,url:i,"data-za-attach-info":c,"data-za-content-type":eH[null==o?void 0:o.contentType]||"Unknown",className:"static",children:(0,g.tZ)(ej,{data:n})})}),eQ=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};function eY(){return Math.max(window.innerHeight/10,100)}var eJ=function(e){for(var t=e;t&&"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType;){var n=document.defaultView.getComputedStyle(t);if([n.overflow,n.overflowY,n.overflowX].some(function(e){return"scroll"===e||"auto"===e}))return t;t=t.parentNode||t.parentElement}return window};function e$(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=eJ(e),r=e.getBoundingClientRect().top+(o.pageYOffset||o.scrollTop||0)-(n?eY():0)-t;o.scrollTo({top:r,behavior:"smooth"})}var e0=/<a\b([^>]*data-draft-type="link-card"[^>]*)>(.*?)<\/a>/g,e1=function(e){var t=e.target,n=e.url,o=e.component,r=e.className;return(0,g.tZ)(o,{target:t,href:n,"data-draft-node":"block","data-draft-type":"link-card","data-is-ecommerce":"1",className:S()("LinkCard",r),children:(0,g.BX)("span",{className:"LinkCard-content LinkCard-ecommerceLoadingCard",children:[(0,g.tZ)("div",{className:"LinkCard-ecommerceLoadingCardAvatarWrapper",children:(0,g.tZ)("img",{src:"https://pic2.zhimg.com/v2-1b0bbef27f0496a58468f92d94c8a80e_l.png",className:"LinkCard-ecommerceLoadingCardNetwork"})}),(0,g.BX)("div",{className:"LinkCard-ecommerceLoadingCardLoadingbar",children:[(0,g.tZ)("span",{}),(0,g.tZ)("span",{})]})]})})};e1.defaultProps={component:"a",target:"_blank"};var e2=/<a\b([^>]*BIZ(=|%3D)ECOMMERCE[^>]*)>(.*?)<\/a>/g,e4=(0,v.forwardRef)(function(e,t){var n=e.color,o=e.className,r=(0,u._)(e,["color","className"]);return(0,g.tZ)("span",(0,s._)({ref:t,className:S()("LinkCard-wrapper",o),style:{background:n&&"string"==typeof n?"linear-gradient(180deg, ".concat((0,O.a)(n).alpha(.12)," 0%, ").concat((0,O.a)(n).alpha(0)," 100%)"):"transparent"}},r))}),e3=(0,v.forwardRef)(function(e,t){var n=e.data,o=e.onClick,r=n.title,a=n.extraInfo,i=(0,v.useMemo)(function(){return eN(a)},[a]);return(0,g.BX)(e4,{color:i.coverColor,ref:t,onClick:o,children:[(0,g.tZ)(eq,{url:i.coverImage,ratio:1.1}),(0,g.BX)("span",{className:"LinkCard-contents",onClick:o,children:[(0,g.tZ)(eM,{children:r}),!!i.subtitle&&(0,g.tZ)("span",{className:"LinkCard-excerpt",children:i.subtitle}),(0,g.tZ)("span",{className:"LinkCard-desc",children:i.metricsText})]})]})}),e6=(0,v.forwardRef)(function(e,t){var n,o=e.data,r=e.onClick,a=o.title,i=o.extraInfo,c=(0,v.useMemo)(function(){return eN(i)},[i]);return(0,g.BX)(e4,{color:c.coverColor,ref:t,onClick:r,children:[(0,g.tZ)(eq,{url:c.coverImage,ratio:1.1}),(0,g.BX)("span",{className:"LinkCard-contents",children:[(0,g.tZ)(eM,{children:a}),!!c.subtitle&&(0,g.tZ)("span",{className:"LinkCard-excerpt",children:c.subtitle}),(0,g.BX)("span",{className:"LinkCard-desc",children:[c.metricsText,null===(n=c.tags)||void 0===n?void 0:n.map(function(e,t){return(0,g.tZ)("span",{children:(0,g.tZ)("span",{className:"LinkCard-tag",children:e})},String([e,t]))})]})]})]})}),e8=(0,v.forwardRef)(function(e,t){var n=e.data,o=e.onClick,r=n.title,a=n.extraInfo,i=(0,v.useMemo)(function(){return eN(a)},[a]);return(0,g.BX)(e4,{color:i.coverColor,ref:t,onClick:o,children:[(0,g.tZ)(eq,{url:i.coverImage,ratio:1.1}),(0,g.BX)("span",{className:"LinkCard-contents",onClick:o,children:[(0,g.tZ)(eM,{children:r}),!!i.subtitle&&(0,g.tZ)("span",{className:"LinkCard-excerpt",children:i.subtitle}),(0,g.BX)("span",{className:"LinkCard-desc",children:[i.metricsText,(0,g.tZ)("span",{children:(0,g.tZ)("span",{className:"LinkCard-tag",children:"播客栏目"})})]})]})]})}),e7=(0,v.forwardRef)(function(e,t){var n=e.data,o=e.onClick,r=n.title,a=n.extraInfo,i=(0,v.useMemo)(function(){return eN(a)},[a]),c=" \xb7 "+(null==i.duration?"--":Math.ceil(i.duration/6e4))+" 分钟";return(0,g.BX)(e4,{color:i.coverColor,ref:t,className:"PodcastEpisodeLinkCard",onClick:o,children:[(0,g.tZ)(eq,{url:i.coverImage,ratio:1.1}),(0,g.BX)("span",{className:"LinkCard-contents",children:[(0,g.tZ)(eM,{twoLine:!0,children:r}),(0,g.BX)("span",{className:"PodcastEpisodeLinkCard-desc",children:[(0,g.tZ)("span",{className:"LinkCard-desc",children:i.podcastChannelTitle}),(0,g.tZ)("span",{className:"PodcastEpisodeLinkCard-duration",children:c}),(0,g.tZ)("span",{className:"PodcastEpisodeLinkCard-collect",children:(0,g.tZ)(X.ZP,{size:"20px",className:"PodcastEpisodeLinkCard-collect-icon"})})]})]}),(0,g.tZ)("span",{className:"PodcastEpisodeLinkCard-play",children:(0,g.tZ)(M.Z,{size:"20px",className:"PodcastEpisodeLinkCard-play-icon"})})]})}),e9=(0,v.forwardRef)(function(e,t){var n,o=e.data,r=e.onClick,a=o.title,i=o.extraInfo,c=(0,v.useMemo)(function(){return eN(i)},[i]);return(0,g.BX)("span",{className:"ZhidaLinkCard",ref:t,onClick:r,children:[(0,g.BX)("span",{className:"ZhidaLinkCard-content",children:[(0,g.BX)("span",{className:"ZhidaLinkCard-header",children:[(0,g.tZ)("span",{className:"ZhidaLinkCard-avatar-container",children:(0,g.tZ)("img",{className:"ZhidaLinkCard-avatar",src:(null===(n=c.author)||void 0===n?void 0:n.avatarUrl)||"https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg",alt:"头像"})}),(0,g.tZ)("span",{className:"ZhidaLinkCard-source",children:c.source})]}),(0,g.tZ)(eM,{children:a}),(0,g.tZ)("span",{className:"ZhidaLinkCard-answer",children:c.summary})]}),(0,g.BX)("span",{className:"ZhidaLinkCard-footer",children:[(0,g.tZ)(j.Z,{size:"16px",className:"ZhidaLinkCard-logo"}),(0,g.tZ)("span",{className:"ZhidaLinkCard-footer-text",children:"去直答提问"}),(0,g.tZ)(H.Z,{size:"16px",className:"ZhidaLinkCard-arrow"})]})]})}),e5=(o={column:e3,"podcast-channel":e8,"podcast-episode":e7,ailab:e6},(0,l._)(o,"zhi-da-session",e9),(0,l._)(o,"zhi-da-share",e9),(0,l._)(o,"zhi-da-folder",e3),o),te=(0,v.forwardRef)(function(e,t){var n=e5[e.data.objectType]||eU;return(0,g.tZ)(n,(0,d._)((0,s._)({},e),{ref:t}))}),tt=function(){function e(t){var n,o,r=this;(0,i._)(this,e),n="fetch",o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.url||(r.url=e),e!==r.url)throw Error("mismatch url\n".concat(e,"\n").concat(r.url),e,r.url);return new Promise(function(e,n){r.addToQueue({options:t,resolve:e,reject:n})})},n in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this.instance=null,this.customFetch=t,this.delay=200,this.maxDelay=1e3,this.url="",this.queueMaxLength=10,this.queue=[],this.startTime=Date.now(),this.timeout=null,this.initialized=!1}return(0,c._)(e,[{key:"initConfig",value:function(e){var t=e.delay,n=e.maxDelay,o=e.maxBatchCount;t&&(this.delay=t),n&&(this.maxDelay=n),o&&(this.maxBatchCount=o),this.initialized=!0}},{key:"buildFetchParams",value:function(e){var t=(0,f._)(e,1)[0].options,n=e.reduce(function(e,t){var n,o;return(null===(o=(n=t.options).dataBuilder)||void 0===o?void 0:o.call(n,e,t))||e},{}),o=this.url,r=!t.method||"GET"===t.method.toUpperCase();if(r){var a=W()(o,!0);a.query=(0,s._)({},a.query,n),o=a.toString()}return[o,(0,d._)((0,s._)({},t),{data:r?null:(0,s._)({},t.data,n)})]}},{key:"doFetch",value:function(){var e=this;return(0,a._)(function(){var t,n,o;return(0,p.__generator)(this,function(r){switch(r.label){case 0:if(0===e.queue.length)return[2];t=e.queue,e.queue=[],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.customFetch.apply(e,(0,m._)(e.buildFetchParams(t)))];case 2:return n=r.sent(),t.forEach(function(e){var t=e.options;(0,e.resolve)(t.resultBuilder?t.resultBuilder(n):n)}),[3,4];case 3:return o=r.sent(),t.forEach(function(e){return e.reject(o)}),[3,4];case 4:return[2]}})})()}},{key:"addToQueue",value:function(e){var t=this;this.initialized||this.initConfig(e.options),clearTimeout(this.timeout),(Date.now()-this.startTime>this.maxDelay||this.queue.length>=this.maxBatchCount)&&(this.startTime=Date.now(),this.doFetch()),this.queue.push(e),setTimeout(function(){t.startTime=Date.now(),t.doFetch()},this.delay)}}]),e}(),tn=null,to=function(e){var t;return t=(0,a._)(function(t,n){return(0,p.__generator)(this,function(o){switch(o.label){case 0:return[4,e(t,n)];case 1:return[4,o.sent().json()];case 2:return[2,o.sent()]}})}),function(e,n){return t.apply(this,arguments)}},tr=function(){throw Error("Not implemented")},ta=function(){var e;return e=to("undefined"!=typeof fetch?fetch:tr),function(t,n){return tn||(tn=new tt(e)),tn.fetch(t,n)}},ti=J()(function(e){var t=e?"/api/v4/content/publish/link_card_infos":"/api/v4/link_card_infos";if(!(0,Q.isBrowser)())return"https://www.zhihu.com".concat(t);var n=window.location,o=n.hostname,r=n.origin;return[".zpres.zhihu.dev",".zpres.zhihu.com"].some(function(e){return o.endsWith(e)})?"".concat(r).concat(t):"https://www.zhihu.com".concat(t)}),tc={},tl=function(e){var t=(0,v.useRef)(0),n=e.inEditor,o=e["data-offset-key"],r=e["data-text"],i=e["data-image"],c=e.href,l=e.onFetchSuccess,u=e.enableNewCardStyle,h=(0,v.useRef)(!1),m=(0,v.useRef)(c),g="draftjs"===n,k=(0,f._)((0,v.useState)(function(){return g&&tc[o]||null}),2),A=k[0],b=k[1],C=(0,f._)((0,w.Y)({once:!0}),2),x=C[0],L=C[1],B=(0,y.A)(function(e){var t=e||A;if(!t||0===Object.keys(t).length)return{objectType:null,title:r||c,thumbnail:i};var n=(0,d._)((0,s._)({},t),{title:r||eE(t)||c,thumbnail:eT(t),cached:!0});return g&&(tc[o]=n),n}),_=(0,y.A)(ta()),z=(0,y.A)((0,a._)(function(){var e;return(0,p.__generator)(this,function(n){switch(n.label){case 0:t.current+=1,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,_(ti(u),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},dataBuilder:function(e){return e.urls="".concat(e.urls?e.urls+",":"").concat(c),e},resultBuilder:function(e){return(0,T.camelizeKeys)(e[c])}})];case 2:return b(B(e=n.sent())),null==l||l((0,d._)((0,s._)({},e),{title:eE(e)}),r),[3,4];case 3:return n.sent(),t.current<=1?z():b(B()),[3,4];case 4:return[2]}})})),Z=!!(!A||!A.cached);return(0,v.useEffect)(function(){(L&&Z||m.current!==c)&&z()},[L,Z,z,c]),(0,v.useEffect)(function(){n&&h.current&&b(B(m.current!==c?{title:r}:null))},[n,B,r,c]),(0,v.useEffect)(function(){m.current=c},[c]),(0,v.useEffect)(function(){h.current=!0},[]),[x,A]},ts=function(e){b.Z.trackCardShow(e,{id:7844},{button:{text:"inlinezvideo"}})},td=function(e,t,n){var o;b.Z.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)},tu=function(e,t,n){var o;b.Z.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)},tf=function(e,t,n){var o=e["data-text"],r=e.href,a=e.zvideoLinkCardProps;(0,v.useEffect)(function(){n&&(0,$.y3)(t.current,function(){return ts(t.current)})},[n,t]);var i=(0,y.A)(function(e){td(e,{title:o,url:r,video:{}})}),c=(0,y.A)(function(e){tu(e,a,{title:o,url:r})});return n?{handleImageClick:i,handleInfoClick:c}:{}},th=(r={answer:"general",article:"general",question:"general",collection:"general",roundtable:"general",topic:"general",zvideo:"video","podcast-channel":"PodcastChannel","podcast-episode":"PodcastEpisode",column:"Column"},(0,l._)(r,"zhi-da-session","zhida"),(0,l._)(r,"zhi-da-share","zhida"),(0,l._)(r,"zhi-da-folder","zhida_repository"),(0,l._)(r,"ailab","ailab"),r),tm=v.forwardRef(function(e,t){var n=N()(e,["zvideoLinkCardProps"]),o=n.inEditor,r=n["data-text"],a=n.href,i=n.className,c=(0,u._)(n,["inEditor","data-text","href","className"]),h=(0,v.useRef)(),m=(0,f._)(tl(e),2),p=m[0],k=m[1],A=tf(e,h,(null==k?void 0:k.objectType)==="zvideo"),b=A.handleImageClick,y=A.handleInfoClick,w=(0,v.useCallback)(el(t,p,h),[]),x=o?te:C.ZAClick,L=o?null:{as:te,shouldTrackShow:!0,zaType:"Block",zaAction:"OpenUrl",zaModuleId:"link_card",extra:{link:{url:a},configMap:{url:a,insert_card_content_type:th[null==k?void 0:k.objectType]||"Unknown"}}},B=(0,g.tZ)(x,(0,d._)((0,s._)({},L),{url:a,data:k,onClick:y,onClickImage:b,language:e.language}));return(0,g.tZ)(eI,(0,d._)((0,s._)({ref:w,text:r,url:a,component:"a",className:S()(i,(0,l._)({},"LinkCard--customStyle",!!(null==k?void 0:k.objectType)&&eR(k.objectType)))},c),{children:!!k&&B}))}),tp=function(e){var t=e.idAttr,n=e.targetClassName;return function(e){var o=e.getAttribute(t),r=document.createElement("div");return r.className=n,e.parentNode.replaceChild(r,e),{data:{id:o},target:r}}},tg=function(e){return function(t){var n=(0,f._)((0,v.useState)(null),2),o=n[0],r=n[1],a=e.idAttr,i=e.selector,c=e.component,l=e.targetClassName,d=e.cardDataFilter,h=e.getCardProps,m=t.root,p=(0,u._)(t,["root"]),k=a&&i&&l&&(0,v.useCallback)(function(e){return tp({idAttr:a,targetClassName:l})(e)},[a,l]),b=(0,v.useMemo)(function(){return k?function(e){return Array.from(e.querySelectorAll(i)).map(k)}:A()},[k,m,i]);return(0,v.useEffect)(function(){if(m||i&&d){var e=(d||b)(m).map(function(e){var t=e.data,n=e.target,o=null;return"function"==typeof h&&(o=h(t)),(0,ee.createPortal)((0,g.tZ)(c,(0,s._)({id:t.id},o,p),t.id),n)});e.length>0&&r(e)}},[m]),o}},tv=tg({cardDataFilter:function(e){return Array.from(e.querySelectorAll("a.LinkCard[data-draft-type=link-card]:not([data-is-ecommerce])")).map(function(e){var t=Array.from(e.attributes).reduce(function(e,t){return"class"===t.name?e.className=t.value:e[t.name]=t.value,e},{}),n=document.createElement("div");return n.className="RichText-LinkCardContainer",e.parentNode.replaceChild(n,e),{data:t,target:n}})},getCardProps:function(e){return e},component:tm}),tk=function(e){return{".LinkCard.old":{position:"relative",display:"block",margin:"1em auto",width:390,boxSizing:"border-box",borderRadius:12,maxWidth:"100%",overflow:"hidden","&,&:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"}},".LinkCard-ecommerceLoadingCard":{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:"inherit",height:80,boxSizing:"border-box",background:e.colorMod(e.colors.GBK10A).alpha(.88),color:e.colors.GBK08A},".LinkCard-ecommerceLoadingCardAvatarWrapper":{width:60,height:60,background:e.colors.GBK09A,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:6,marginRight:10},".LinkCard-ecommerceLoadingCardNetwork":{width:20,height:20},".LinkCard-ecommerceLoadingCardLoadingbar":{height:60,flex:1,display:"flex",flexDirection:"column",span:{height:16,display:"inline-block",background:e.colors.GBK09A},"span:nth-of-type(1)":{width:60,marginBottom:4},"span:nth-of-type(2)":{width:127}}}},tA=function(e){var t={fontSize:13,height:18,lineHeight:"18px",color:e.colors.MapText06A,wordBreak:"break-all"};return{position:"relative",display:"flex",boxSizing:"border-box",flexDirection:"row",alignItems:"center",width:390,minHeight:90,borderRadius:8,maxWidth:"100%",overflow:"hidden",margin:"16px auto",padding:"12px",backgroundColor:e.colors.GBK10A,"&, &:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"},"&.LinkCard--customStyle":{display:"block",padding:0,background:"linear-gradient(180deg, ".concat(e.colors.MapUIFrame99C," 0%, ").concat(e.colorMod(e.colors.MapUIFrame10A).alpha(.4)," 100%)"),"& .LinkCard-wrapper":{display:"flex",boxSizing:"border-box",flexDirection:"row",alignItems:"center",minHeight:90,padding:12},"& .LinkCard-image":{width:66,height:66,borderRadius:"6px",marginRight:12,marginLeft:0}},".LinkCard-contents":{display:"block",flex:"1 1 auto",position:"relative",".loading":{height:14,background:e.colors.GBK09A,borderRadius:7},"&.withTitle":{marginBottom:3}},".LinkCard-title":(0,d._)((0,s._)({display:"block",fontSize:15,fontWeight:500,lineHeight:1.4,marginBottom:4,color:e.colors.GBK02A},(0,F.S)(1)),{"&.two-line":(0,s._)({lineHeight:"20px"},(0,F.S)(2)),"&.loading":{marginBottom:8,width:"80%","&.withTitle":{marginBottom:6}},"&.loadingTitle":{marginBottom:5}}),".LinkCard-excerpt":(0,d._)((0,s._)((0,d._)((0,s._)({display:"block",textOverflow:"ellipsis"},t),{marginBottom:4}),(0,F.S)(1)),{".LinkCard-author":{color:e.colors.GBK03A}}),".LinkCard-desc":(0,d._)((0,s._)({display:"block"},t),{".LinkCard-tag,.tag":{display:"inline-block",fontSize:11,marginLeft:6,padding:"0 4px",borderRadius:3,lineHeight:"16px",background:e.colors.MapUIFrame09A},"&.loading":{width:"40%"},svg:{marginRight:2}}),".LinkCard-desc-wrapper":{overflow:"visible",whiteSpace:"nowrap"},".LinkCard-desc-wrapper-line-clamp":(0,s._)({},(0,F.S)(1)),".LinkCard-image":{flex:"0 0 auto",backgroundColor:e.colors.GBK09A,backgroundSize:"cover",backgroundPosition:"center",position:"relative",display:"block",width:66,height:66,marginRight:12,marginLeft:0,objectFit:"cover",borderRadius:"6px",overflow:"hidden","&.LinkCard-image--default":{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.colors.GBK09A,color:e.colors.GBK08A,svg:{color:e.colors.GBK06A}},img:{width:"100%",height:"100%",objectFit:"cover"},".LinkCard-image--video":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)",width:24,height:24,borderRadius:12,background:e.colorMod(e.colors.GBK99C).alpha(.9),pointerEvents:"none",svg:{color:e.colors.GBK03A}}},".LinkCard-richText":{".text":{color:e.colors.GBK03A},".bold":{fontWeight:e.fontWeights.bold},".tag":{marginLeft:8}},".LinkCard-richText object":{display:"flex",alignItems:"center"},".PodcastEpisodeLinkCard-desc":{display:"flex",alignItems:"center"},".PodcastEpisodeLinkCard-duration":(0,d._)((0,s._)({},t),{flex:"0 0 auto",marginRight:"15px"}),".PodcastEpisodeLinkCard-collect":{height:18,width:20,flex:"0 0 20px",marginLeft:"auto",color:e.colors.MapText05A,position:"relative"},".PodcastEpisodeLinkCard-collect-icon":{position:"absolute",bottom:0,right:0},".PodcastEpisodeLinkCard-play":{height:34,width:34,flex:"0 0 34px",marginLeft:"auto",color:e.colors.MapBrand,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.colorMod(e.colors.MapBrand).alpha(.08),alignSelf:"flex-end"},".PodcastEpisodeLinkCard-play-icon":{marginLeft:"2px"},".PodcastEpisodeLinkCard .LinkCard-contents":{marginRight:"12px"},".ZhidaLinkCard":{display:"flex",flexDirection:"column",maxWidth:390,borderRadius:8,overflow:"hidden",border:"1px solid ".concat(e.colors.MapUIFrame09A)},".ZhidaLinkCard-content":{display:"block",padding:"12px 12px 10px"},".ZhidaLinkCard-header":{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:8},".ZhidaLinkCard-avatar-container":{display:"flex",alignItems:"center",flex:"0 0 auto"},".ZhidaLinkCard-avatar":{width:16,height:16,borderRadius:"100%",objectFit:"cover"},".ZhidaLinkCard-source":(0,s._)({marginLeft:6,fontSize:12,lineHeight:"16px",color:e.colors.MapText06A},(0,F.S)(1)),".ZhidaLinkCard-answer":(0,s._)({display:"block",fontSize:13,lineHeight:"19px",color:e.colors.MapText04A},(0,F.S)(3)),".ZhidaLinkCard-footer":{display:"flex",alignItems:"center",padding:"10px 12px",backgroundColor:e.colors.GBK10A,cursor:"pointer",lineHeight:"19px"},".ZhidaLinkCard-logo":{display:"flex",alignItems:"center",justifyContent:"center",fill:e.colors.MapAI},".ZhidaLinkCard-footer-text":{display:"block",fontSize:13,fontWeight:500,lineHeight:"19px",color:e.colors.GBK02A,marginLeft:6},".ZhidaLinkCard-arrow":{color:e.colors.MapAI,marginLeft:"auto"}}},tb=function(e){return{".LinkCard.new":tA(e)}},tC=function(e){return(0,v.forwardRef)(function(t,n){return(0,g.tZ)(e,(0,s._)({css:tb,ref:n},t))})},ty=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,(0,s._)({credentials:"include",headers:{"X-Requested-With":"Fetch"}},t)).then(function(e){return e.json()})},tw=function(e){return(0,s._)({},tk(e),tb(e))},tx=function(e){return(0,s._)({},tb(e),tk(e))},tL=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.rootMargin,r=n.threshold,a=n.once,i=void 0===a||a;e=Array.isArray(e)?e:e?[e]:[];var c=(0,v.useRef)(null),l=(0,y.A)(t);(0,v.useEffect)(function(){if(e.length)return c.current&&e.forEach(function(e){return c.current.unobserve(e)}),c.current=new IntersectionObserver(function(e){e.forEach(function(e){e.intersectionRatio>0&&(l(e),i&&c.current.unobserve(e.target))})},{rootMargin:o,threshold:r}),e.forEach(function(e){return c.current.observe(e)}),function(){e.forEach(function(e){return c.current.unobserve(e)})}},[e,o,JSON.stringify(r),i])},tB=n(18837),t_="function"==typeof Image,tz={},tZ=t_?tB(function(e){return new Promise(function(t){var n,o;return n=function(e,n){tz[e]=n,t(n)},void((o=new Image).onload=function(){var t=o.width>0&&o.height>0;n(e,t)},o.onerror=function(){n(e,!1)},o.src="data:image/webp;base64,"+({lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"})[e])})}):function(){return Promise.resolve(!1)},tS=function(e){var t=tz[e],n=(0,f._)((0,v.useState)(t),2),o=n[0],r=n[1];return t_&&void 0===t&&tZ(e).then(r),o},tI={class:"className"},tG=(0,v.forwardRef)(function(e,t){var n=e.node,o=e.tagName,r=(0,u._)(e,["node","tagName"]),a=(0,v.useMemo)(function(){return Array.from(n.attributes).reduce(function(e,t){var n=tI[t.name]||t.name;return"style"!==n&&(e[n]=t.value),e},{})},[n]);return(0,v.createElement)(o||n.tagName.toLowerCase(),(0,d._)((0,s._)({},a,r),{ref:t}))}),tR=en()(function(){return/Mobile/.test(navigator.userAgent)}),tN=function(e){var t=e.image,n=e.enableWebP,o=e.size,r=e.quality,a=t.dataset,i=a.actualsrc,c=a.actualgif;return n&&c&&c.match(/.gif$/i)?i:(o||(o="720w",!tR()&&window.devicePixelRatio>=1.5&&(o="1440w"),tR()&&window.devicePixelRatio*window.innerWidth>=1080&&(o="1440w")),(0,E.imgUrl)(i,{quality:void 0===r?80:r,size:o}))};function tE(e,t){b.Z.trackMonitor({name:t},{monitor:{type:"Event",imgResourceErrorInfo:{error_description:t,img_url:e,img_from:"web"}}})}var tT=function(e){var t=e.onLoadStateChange,n=e.onImageLoaded,o=e.enableWebP,r=e.size,a=e.quality;return function(e){var i=e.target,c=tN({image:i,enableWebP:o,size:r,quality:a});if(o&&(c=c.replace(/\.(jpg|png|jpeg|gif)/,".webp")),i.dataset.rawheight&&!i.getAttribute("height")&&i.setAttribute("height",i.dataset.rawheight),i.src=c,i.complete){i.dataset.lazyStatus="ok",null==n||n();return}t&&i.addEventListener("loadstart",function(){t("loadstart",c)}),i.dataset.lazyStatus="loading";var l=setTimeout(function(){i.complete||tE(i.url,"image_web_timeout_image"),t&&t("timeout",c)},15e3);i.addEventListener("load",function(){i.dataset.lazyStatus="ok",clearTimeout(l),tE(i.url,"image_web_success_image"),t&&t("load",c),null==n||n()}),i.addEventListener("error",function(){clearTimeout(l),tE(i.url,"image_web_fail_image"),t&&t("error",c)})}},tP=function(e){var t=e.node,n=e.useWebP,o=e.onLoadStateChange,r=e.size,a=e.quality,i=e.index,c=t.classList.contains("lazy"),l=tS("lossless"),s=(0,f._)((0,w.Y)({once:!0,rootMargin:"600px"}),3),d=s[0],u=s[1],h=s[2],m=(0,f._)((0,x.k)(!c),2),p=m[0],k=m[1],A=(0,y.A)(k.on),b=(0,y.A)(tT({onLoadStateChange:o,onImageLoaded:A,enableWebP:l&&(void 0===n||n),size:r,quality:a}));(0,v.useEffect)(function(){u&&b(h)},[h,u,b]);var B=(0,v.useMemo)(function(){return{elementLocation:{type:"Image",moduleId:"image_card",moduleIndex:i}}},[i]),_=(0,C.useShow)(B),z=(0,L.q)(p?_:void 0,c?d:void 0),Z=(0,C.useTracker)().trackEvent,S=(0,y.A)(function(){return p&&Z(B)});return(0,g.tZ)(tG,{node:t,ref:z,onClick:S})},tW=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.useWebP,o=t.disabled,r=void 0!==o&&o,a=t.onLoadStateChange,i=t.size,c=t.quality,l=(0,f._)((0,v.useState)([]),2),s=l[0],d=l[1];tL(s,tT({onLoadStateChange:a,enableWebP:tS("lossless")&&(void 0===n||n),size:i,quality:c}),{rootMargin:"300px"}),(0,v.useEffect)(function(){if(e&&!r){var t=Array.from(e.querySelectorAll("img.lazy:not([data-thumbnail])"));t.length&&d(t)}},[e,r])},tD=function(e){return tW(e.root,e.options),null},tM=function(e,t){b.Z.trackEvent(e,{action:"StatusReport",element:"Card"},{status:{result:t}})},tK=function(e,t){var n,o;null==window||null===(n=window.Raven)||void 0===n||null===(o=n.captureException)||void 0===o||o.call(n,e,{fingerprint:["gif2mp4"],extra:t})},tV=function(e){var t=e.src,n=e.useWebP,o=void 0===n?"auto":n,r=e.useMp4,a=void 0!==r&&r,i=e.onRef,c=e.onLoadStateChange,l=e.onPlayChange,d=(0,u._)(e,["src","useWebP","useMp4","onRef","onLoadStateChange","onPlayChange"]),h=(0,f._)((0,v.useState)(""),2),m=h[0],p=h[1],k=(0,f._)((0,v.useState)(null),2),C=k[0],y=k[1],w=(0,f._)((0,v.useState)(Date.now()),2),x=w[0],L=w[1],_=(0,f._)((0,v.useState)(!1),2),z=_[0],Z=_[1],S=(0,f._)((0,v.useState)(null),2),I=S[0],G=S[1],R=tS("animation"),N=(0,v.useCallback)(function(){var e=((0,eo.imgPathParse)(t)||{}).hash;a&&(0,$.y3)(C,function(){fetch("https://api.zhihu.com/gif2mp4/".concat(e),{credentials:"include",headers:{"X-Requested-With":"Fetch"}}).then(function(e){return e.json()}).then(function(e){var t,n,o=e.playlist,r=(null==o?void 0:null===(t=o.SD)||void 0===t?void 0:t.play_url)||(null==o?void 0:null===(n=o.LD)||void 0===n?void 0:n.play_url);r&&er.ZP.increment("Gif2Mp4Player.mp4.fetch.success.count"),p(r)}).catch(A())})},[C,t,a]);(0,v.useEffect)(N,[t,a,C]),(0,v.useEffect)(function(){C&&b.Z.setModule(C,{module:"GifItem"})},[C]),tL(C,function(){b.Z.trackCardShow(C,{element:"Card"})}),(0,B.K)(function(){er.ZP.increment("Gif2Mp4Player.mp4.play.failure.count"),tK(Error("Gif2Mp4 play timeout"),{src:t,videoUrl:m}),Z(!1)},z?2e3:null),(0,B.K)(function(){er.ZP.increment("Gif2Mp4Player.mp4.play.success.count"),er.ZP.timing("Gif2Mp4Player.mp4.first_frame_time",Date.now()-x-100),Z(!1),G(null)},I);var E=(0,eo.default)(t,{extension:("auto"===o?R:o)?"webp":"gif"});return(0,g.tZ)(ei.ZP,(0,s._)({videoUrl:m,src:E,onRef:(0,v.useCallback)(el(i,y),[]),onPlayChange:function(e){null==l||l(e),e||(L(Date.now()),m&&(er.ZP.increment("Gif2Mp4Player.mp4.click.count"),Z(!0)),b.Z.trackEvent(C,{action:"Click",element:"Image"}))},onLoadStart:function(){if(m){var e=ea.parse(m).expiration;e&&Number(e)<Date.now()/1e3+900&&N()}L(Date.now()),c&&c("loadstart",E)},onSuccess:function(){tM(C,"Success"),m?z&&G(100):er.ZP.timing("Gif2Mp4Player.gif.first_frame_time",Date.now()-x),c&&c("load",E)},onFailed:function(e){tM(C,"Fail"),m&&(z&&(er.ZP.increment("Gif2Mp4Player.mp4.play.failure.count"),Z(!1),G(null)),tK(e,{videoUrl:m,src:t})),c&&c("error",E)}},d))},tq=function(e){var t=e.dataset,n=t.thumbnail,o=t.size,r=t.rawheight;return{src:n,poster:n,size:o,width:t.rawwidth,height:r}},tU=function(e){var t=e.node,n=e.Component,o=void 0===n?tV:n,r=(0,v.useMemo)(function(){return tq(t)},[t]);return(0,g.tZ)(o,(0,s._)({},r))},tX=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.Component,o=void 0===n?tV:n,r=(0,f._)((0,v.useState)(null),2),a=r[0],i=r[1];return(0,v.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll("img.origin_image[data-thumbnail],img.content_image[data-thumbnail]"));t.length&&i(t.map(function(e,t){var n=document.createElement("div");return n.className="RichText-gifPlaceholder",e.parentNode.replaceChild(n,e),(0,ee.createPortal)((0,g.tZ)(tU,{node:e,Component:o},t),n)}))}},[e]),a},tj=function(e){return tX(e.root,e.options)},tH=function(e){var t=e.root,n=e.ConditionalImage,o=(0,f._)((0,v.useState)([]),2),r=o[0],a=o[1];return(0,v.useEffect)(function(){if(t){var e=Array.from(t.querySelectorAll("img.origin_image,img.content_image"));e.length&&a(e.map(function(e,t){var o=document.createElement("div");return e.parentNode.replaceChild(o,e),(0,ee.createPortal)((0,g.tZ)(n,{index:t,node:e},t),o)}))}},[t]),r},tO=es([function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).linkCardInfo;return e?e.replace(e0,function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=(0,V.f)(n,{decodeValue:!0}),a=r.target,i=r.href,c=void 0===i?"":i,l=r["data-image"],d=r["data-image-width"],u=r["data-image-height"],f=r["data-entity-type"],h=r["data-entity-data"],m=r["data-size"];if(r["data-is-ecommerce"])return e;var p=o.replace(/<[^>]*>/g,"");p=(0,V.p)(p);var v=t?eF:eI;return(0,G.renderToStaticMarkup)((0,g.tZ)(v,(0,s._)({text:p,url:c,target:void 0===a?"_blank":a,image:l,imageWidth:d,imageHeight:u,entityType:f,entityData:eQ(h),size:m},t&&{data:t[c]})))}):e},function(e){return e?e.replace(e2,function(e,t){var n=(0,V.f)(t,{decodeValue:!0}),o=n["data-draft-type"],r=n.href,a=n.class;return"link-card"!==o?e:(0,G.renderToStaticMarkup)((0,g.tZ)(e1,{url:r,className:U()(a,{old:!0,new:!1,static:!1})}))}):e}]),tF=(0,v.forwardRef)(function(e,t){var n=(0,f._)((0,v.useState)(null),2),o=n[0],r=n[1],a=e.html,i=e.css,c=e.options,l=void 0===c?{}:c,d=e.ConditionalImage,h=e.linkCardInfo,m=e.language,p=(0,u._)(e,["html","css","options","ConditionalImage","linkCardInfo","language"]),k=l.lazyLoadImageOptions,A=l.useGifPortalOption,b=(0,u._)(l,["lazyLoadImageOptions","useGifPortalOption"]);ef(o);var C=[tw,tx,i].reduce(function(e,t){return(t||(t={}),"function"==typeof t)?function(n){return(0,s._)({},e(n),t(n))}:function(n){return(0,s._)({},e(n),t)}},function(e){return{}}),y=(0,v.useCallback)(el(t,r),[]);return(0,g.BX)(v.Fragment,{children:[!h&&(0,g.tZ)(tv,{css:tx,root:o,language:m,enableNewCardStyle:!0}),d?(0,g.tZ)(tH,{root:o,ConditionalImage:d}):(0,g.BX)(g.HY,{children:[(0,g.tZ)(tD,{root:o,options:k}),(0,g.tZ)(tj,{root:o,options:A})]}),(0,g.tZ)(ev,{root:o}),(0,g.tZ)(eZ,(0,s._)({ref:y,html:tO(a,{linkCardInfo:h}),css:C,root:o,options:b},p))]})}),tQ=/<sup\b([^>]*data-draft-type="reference"[^>]*)>(.*?)<\/sup>/g}}]);
//# sourceMappingURL=lib-0e5ce61e.app.dc2f0d11c2b142b2b9f4.js.map